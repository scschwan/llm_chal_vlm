<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>불량 이미지 등록 - 관리자</title>
    <link rel="stylesheet" href="/static/admin/css/admin_image_defect.css">
</head>
<body>
    <div class="container">
        <!-- <a href="/admin.html" class="back-link">← 관리자 대시보드로 돌아가기</a> -->
         <a href="/admin/dashboard.html" class="btn">← 대시보드로 돌아가기</a>
        
        <h1>불량 이미지 등록</h1>
        
        <div id="message" class="message"></div>
        
        <!-- 이미지 업로드 폼 -->
        <div class="form-section">
            <h2>이미지 업로드</h2>
            <form id="uploadForm">
                <div class="form-group">
                    <label for="productId">제품 선택 *</label>
                    <select id="productId" name="product_id" required onchange="loadDefectTypes()">
                        <option value="">-- 제품을 선택하세요 --</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="defectTypeId">불량 유형 선택 *</label>
                    <select id="defectTypeId" name="defect_type_id" required>
                        <option value="">-- 제품을 먼저 선택하세요 --</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>파일 선택 (jpg, png, zip)</label>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">⚠️</div>
                        <p><strong>클릭하여 파일 선택</strong> 또는 드래그 앤 드롭</p>
                        <p style="font-size:0.9em; color:#999; margin-top:5px;">
                            다중 선택 가능 / ZIP 파일 지원
                        </p>
                        <input type="file" id="fileInput" multiple accept=".jpg,.jpeg,.png,.zip" style="display:none;">
                    </div>
                    
                    <div id="fileList" class="file-list" style="display:none;"></div>
                </div>
                
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <div class="progress-info" id="progressInfo"></div>
                </div>
                
                <button type="submit" class="btn btn-primary" id="uploadBtn" style="margin-top:15px;">업로드</button>
            </form>
            
            <div class="note">
                ※ 이미지는 Object Storage에 업로드됩니다.<br>
                ※ 파일명은 자동으로 {제품코드}_{불량코드}_{순번} 형식으로 변경됩니다.<br>
                ※ 업로드 완료 후 서버 배포를 수행해야 인덱싱됩니다.
            </div>
        </div>
        
        <!-- 등록된 이미지 갤러리 -->
        <div class="gallery-section">
            <h2>등록된 불량 이미지</h2>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalCount">0</div>
                    <div class="stat-label">총 이미지 수</div>
                </div>
            </div>
            
            <div class="filter-section">
                <div>
                    <label for="filterProduct">제품 필터:</label>
                    <select id="filterProduct" onchange="loadFilterDefectTypes()">
                        <option value="">전체 제품</option>
                    </select>
                </div>
                <div>
                    <label for="filterDefectType">불량 유형:</label>
                    <select id="filterDefectType" onchange="filterImages()">
                        <option value="">전체 불량</option>
                    </select>
                </div>
            </div>
            
            <div id="imageGrid" class="image-grid">
                <!-- 동적으로 채워짐 -->
            </div>
        </div>
    </div>
    
    <script src="/static/admin/js/admin_image_defect.js"></script>
</body>
</html>